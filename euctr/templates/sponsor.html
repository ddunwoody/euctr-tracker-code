{% extends "base.html" %}

{% block title %}Is {{ sponsor_name }} late reporting EU clinical trials?{% endblock %}

{% block content %}

  <div class="container">
    <h1>Is {{ sponsor_name }} late reporting EU clinical trials?</h1>

    <div class="lead">
      <p>Out of {{total_due}} <span title="Trials which are listed as completed with a completion date, and the date is more than a year ago" data-toggle="tooltip" data-placement="bottom">due trials</span> in the
      <a href="https://www.clinicaltrialsregister.eu/">EUCTR</a>,
     
      {% if percent_unreported > 0 %}
        sponsor {{ sponsor_name }} is <b>late</b> reporting results for {{total_unreported}} of them. 
        </p>
         <p>They're <b>breaking the law</b> for <b>{{percent_unreported}}%</b>
         of their trials. 
        </p>
      {% else %}
        sponsor {{ sponsor_name }} is <b>on time</b> reporting results for all {{total_reported}}.
        <p>They're <b>obeying the law</b> for <b>{{percent_reported}}%</b>
        of their trials.
      {% endif %}
    </div>

    <div class="lead">
         <a href="/about">Why's this matter?</a>
    </div>
    
    <!-- <p>In addition XX trials have errors or problems in their
    data. Many of these trials will be due to reported results too. You can see
    the specific trials that are overdue, or contain errors, in the list
    below.
    </p> -->

    <h2>{{ sponsor_name }}'s due trials</h2>

    <div id="trials_table_loading">
      <span class="glyphicon glyphicon-refresh spinning"></span>
    </div>

    <table id="trials_table" class="display" cellspacing="0" width="100%">
      <script>
        hide_trials_datatable()
      </script>

      <thead>
        <tr>
          <th>Trial ID</th>
          <th>Title</th>
          <th>Status</th>
          <th>Completion date</th>
          <th>Results posted</th>
        </tr>
      </thead>

      {% for trial in trials %}
        {% if trial.has_results == 0 %}
        <tr class="no_results">
        {% else %}
        <tr>
        {% endif %}
        <td><a href="{{ trial.trial_url}}">{{ trial.trial_id }}</a></td>
          <td>{{ trial.trial_title }}</td>

          <td>
			  {% if trial.overall_status == "ongoing" %}
				  Ongoing
			  {% elif trial.overall_status == "error-ongoing-has-comp-date" %}
				  Registry inconsistent &mdash; ongoing but has completion date
			  {% elif trial.overall_status == "completed_not_due" %}
				  Completed &mdash; not due
			  {% elif trial.overall_status == "completed-due" %}
				  Completed &mdash; due
			  {% elif trial.overall_status == "reported-early" %}
				  Reported &mdash; early
			  {% elif trial.overall_status == "reported" %}
				  Reported
			  {% elif trial.overall_status == "error-completed-no-comp-date" %}
				  Registry inconsistent &mdash; completed but no completion date
			  {% elif trial.overall_status == "not run" %}
				  Suspended, withdrawn, not authorised or prohibited by CA
			  {% elif trial.overall_status == "no-trial status" %}
				  No trial status
			  {% else %}
				  EUCTR internal error &mdash; {{ trial.overall_status }}
			  {% endif %}
          </td>

          <td>{{ trial.max_end_date | default_if_none:"-"}}</td>
          {% if trial.has_results == 0 %}
            <td>-</td>
          {% elif trial.has_results == 1%}
            <td>yes</td>
          {% else %}
            <td>{{ trial.has_results }}</td>
          {% endif %}
        </tr>
      {% endfor %}
    </table>

    <script>
      activate_trials_datatable()
    </script>

    <div class="prominent_link"><a href="/">
      Look up other sponsors &raquo;      
    </div>

  </div>


{% endblock%}
